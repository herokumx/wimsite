@model List<WorkersInMotion.Model.ViewModel.MarketModel>
@{
    //    Layout = null;
}

<!DOCTYPE html>

<html lang="en" class="no-js">
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Dashboard</title>
    <style>
        .gridFooter td {
            padding: 10px;
            color: #999;
            font-size: 10pt;
            text-align: left;
        }

        .gridFooter a:hover {
            color: #333;
            border: 1px green solid;
            padding: 5px;
            text-decoration: none;
        }

        .gridFooter a {
            color: #333;
            border: 1px #ddd solid;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN PAGE TITLE & BREADCRUMB-->
            <h3 class="page-title">
                Dashboard <small>statistics and more</small>
            </h3>
            <ul class="page-breadcrumb breadcrumb">
                <li>
                    <i class="icon-home"></i><a href="#">Home</a> <i class="icon-angle-right"></i>
                </li>
                <li><a href="#">Dashboard</a></li>
            </ul>
            <!-- END PAGE TITLE & BREADCRUMB-->
        </div>
    </div>
    <div class="clearfix">
    </div>
    <div class="row">
        <div class="col-md-6 col-sm-6">
            <!-- BEGIN PORTLET-->
            <div class="portlet box light-grey">
                <div class="portlet-title">
                    <div class="caption"><i class="icon-bar-chart"></i>Store Visit / Non Visit</div>
                    @if (Session["UserType"] != null && !string.IsNullOrEmpty(Session["UserType"].ToString()) && Session["UserType"].ToString() == "ENT_A")
                    {
                        <table align="right">
                            <tr>
                                <td style="padding-left:10px">
                                    @Html.Raw(@ViewBag.FilterList)
                                </td>
                            </tr>
                        </table>
                    }
                </div>

                <div class="portlet-body">
                    <div>
                        <span style="color:red;font-size:10px;">&nbsp;</span>
                    </div>
                    <div id="pie_chart_3" class="chart" style="padding: 0px; position: relative;">
                    </div>
                    <div style="width:100%" align="center">
                        <span style="color:red;font-size:10px;text-align:center">&nbsp;</span>
                    </div>
                </div>
            </div>
            <!-- END PORTLET-->
        </div>
        <div class="col-md-6 col-sm-6">
            <!-- BEGIN PORTLET-->
            <div class="portlet box light-grey">
                <div class="portlet-title">
                    <div class="caption"><i class="icon-bar-chart"></i>User Activities</div>

                    <table align="right">
                        <tr>
                            <td style="padding-left:10px">
                                @Html.Raw(@ViewBag.UserActivityDropdown)
                            </td>
                        </tr>
                    </table>
                </div>

                <div class="portlet-body" style="display: block;">
                    <div id="chart_1_1_legendPlaceholder">
                        <span style="color:red;font-size:10px;">Job Count</span>
                    </div>
                    <div id="chart_1_1" class="chart" style="padding: 0px; position: relative;">
                        <canvas class="flot-base" width="1067" height="300" style="direction: ltr; position: absolute; left: 0px; top: 0px; width: 1067px; height: 300px;"></canvas>
                        <div class="flot-text" style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 0px; font-size: smaller; color: rgb(84, 84, 84);">
                            <div class="flot-x-axis flot-x1-axis xAxis x1Axis" style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 0px; display: block;">
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 73px; text-align: center;">2</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 178px; text-align: center;">4</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 282px; text-align: center;">6</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 387px; text-align: center;">8</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 488px; text-align: center;">10</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 593px; text-align: center;">12</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 698px; text-align: center;">14</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 802px; text-align: center;">16</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 907px; text-align: center;">18</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; max-width: 88px; top: 284px; left: 1011px; text-align: center;">20</div>
                            </div>
                            <div class="flot-y-axis flot-y1-axis yAxis y1Axis" style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 0px; display: block;">
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 272px; left: 13px; text-align: right;">0</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 217px; left: 7px; text-align: right;">50</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 163px; left: 1px; text-align: right;">100</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 109px; left: 1px; text-align: right;">150</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 55px; left: 1px; text-align: right;">200</div>
                                <div class="flot-tick-label tickLabel" style="position: absolute; top: 1px; left: 1px; text-align: right;">250</div>
                            </div>
                        </div>

                        <canvas class="flot-overlay" width="1067" height="300" style="direction: ltr; position: absolute; left: 0px; top: 0px; width: 1067px; height: 300px;"></canvas>

                    </div>
                    <div style="width:100%" align="center">
                        <span style="color:red;font-size:10px;text-align:center">-----------Day ------------</span>
                    </div>
                </div>
            </div>

            <!-- END PORTLET-->
            <!-- BEGIN PORTLET-->
            <!-- END PORTLET-->
        </div>
    </div>
    <div>
@using (Html.BeginForm("Dashboard", "User", FormMethod.Get)) {
        if (Model != null && Model.Count > 0)
        {
            <div class="portlet box light-grey">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-calendar"></i>Store Non Visit
                    </div>
                    <table align="right">
                        <tr>
                            <td style="padding-left:10px">
                                @if (ViewBag.FromDate != null && ViewBag.ToDate != null)
                                {
                                    <a href="@Url.Action("Index", "StoreVisit", new { id = "Non-Visits", FromDate = ViewBag.FromDate, ToDate = ViewBag.ToDate, LastModifiedDate = ViewBag.LastModifiedDate })" class="btn green">
                                    View Full Report <i class='icon-plus'></i>
                                    </a>
                                }
                                else
                                {
                                    <a href="@Url.Action("Index", "StoreVisit", new { id = "Non-Visits" })" class="btn green">
                                        View Full Report <i class='icon-plus'></i>
                                    </a>
                                }
                            </td>
                        </tr>
                    </table>
                </div>

                <div class="portlet-body">
                    <div id="sample_editable_3_wrapper" class="dataTables_wrapper" role="grid">
                        @Html.ValidationSummary(false)
                        @if (ViewBag.TotalRows > 0)
                        {
                            <div class="col-md-6 col-sm-12">
                                <div id="sample_1_length" class="dataTables_length">
                                    <label style="margin-left:-15px;">
                                        @Html.DropDownList("RowCount", (SelectList)ViewBag.pCountList, new { @onchange = "this.form.submit();", @class = "form-control input-small" })
                                        records
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-12">
                                <div class="dataTables_filter" id="sample_1_filter">
                                    <label style="margin-right:-15px;">
                                        Search:
                                        @Html.TextBox("search", "", new { @style = "padding-right:1%", @class = "form-control input-medium input-inline" })
                                        <button type="submit" class="btn green pull-right">
                                            Submit <i class="m-icon-swapright m-icon-white"></i>
                                        </button>
                                        @*<input type="text" aria-controls="sample_1" class="form-control input-medium input-inline">*@
                                    </label>
                                </div>
                            </div>

                            <div class="table-scrollable">
                                @{
                            var obj = new WebGrid(rowsPerPage: ViewBag.pageCountValue, canPage: true);
                            obj.Bind(source: Model, rowCount: ViewBag.TotalRows, autoSortAndPage: false);
                                }
                                @obj.GetHtml(htmlAttributes: new { @class = "table table-striped table-hover table-bordered", @id = "sample_1_info", @style = "overflow-y:scroll" },
                                                  mode: WebGridPagerModes.Numeric | WebGridPagerModes.NextPrevious,
                                                  nextText: "Next",
                                                  previousText: "Previous",
                                                   numericLinksCount: 10,
                                    footerStyle: "gridFooter",
                                    alternatingRowStyle: "gradeX even",
                             rowStyle: "gradeX odd",
                                                  columns: obj.Columns(

                    obj.Column("RegionName", header: "Region"),
                    obj.Column("MarketID", header: "Store ID"),
                     obj.Column("MarketName", header: "Store Name")
                 ))
                            </div>
                        }
                        else
                        {
                            <label>No Data Found</label>
                        }
                    </div>
                </div>



            </div>
        }
}
    </div>

    <div class="clearfix">
    </div>
    <!-- END CORE PLUGINS -->
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
    <script src="~/assets/scripts/charts.js"></script>

    <script type="text/javascript">
        //init_Chart('@ViewBag.jobopen', '@ViewBag.jobcomplete');
        $(function () {
            TableEditable.init();
            ComponentsPickers.init();
            //App.init();
            //Charts.init();
            //Charts.initCharts();

            //prabhu -I made custom piechart
            if ('@ViewBag.Flag' == "true") {
                var testJSON = JSON.parse('@ViewBag.VisitPercentage'.replace(/&quot;/g, '"'));
                // alert(testJSON);
                Charts.initPieCharts(testJSON, parseInt('@ViewBag.Series'));
            }
            else {
                Charts.initPieCharts();
            }
            if ('@ViewBag.Activity' == "true") {
                Charts.initBarCharts('@ViewBag.UserActivityList');
            }
        });
        function init_Chart(jobopen, jobcomplete) {
            //            //  alert(jobopen);
            //            var jobopen = {};
            //            var jobcomplete = {};
            //            if (jobopen != undefined)
            //                jobopen = eval(jobopen);
            //            if (jobcomplete != undefined)
            //                jobcomplete = eval(jobcomplete);
            var jobopenarr = $.map(eval(jobopen), function (value, index) {
                return [value];
            });
            var jobcompletearr = $.map(eval(jobcomplete), function (value, index) {
                return [value];
            });
            Index.initCharts(jobopenarr, jobcompletearr);

            return false;
        }
    </script>
</body>
</html>
